const vision = require("@google-cloud/vision");
const imgURL = `data:image/png;base64,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`;
(async function main() {
	try {
		// Creates a client
		const client = new vision.ImageAnnotatorClient();
		// Read a local image as a text document
		const [result] = await client.documentTextDetection("./captcha.png");
		const fullTextAnnotation = result.fullTextAnnotation;
		console.log(`Full text: ${fullTextAnnotation.text}`);
		fullTextAnnotation.pages.forEach((page) => {
			page.blocks.forEach((block) => {
				console.log(`Block confidence: ${block.confidence}`);
				block.paragraphs.forEach((paragraph) => {
					console.log(`Paragraph confidence: ${paragraph.confidence}`);
					paragraph.words.forEach((word) => {
						const wordText = word.symbols.map((s) => s.text).join("");
						console.log(`Word text: ${wordText}`);
						console.log(`Word confidence: ${word.confidence}`);
						word.symbols.forEach((symbol) => {
							console.log(`Symbol text: ${symbol.text}`);
							console.log(`Symbol confidence: ${symbol.confidence}`);
						});
					});
				});
			});
		});
		// /**
		// const bucketName = "Bucket where the file resides, e.g. my-bucket";
		// const fileName = "Path to file within bucket, e.g. path/to/image.png";

		// // Performs text detection on the gcs file
		// // const [result] = await client.textDetection(`gs://${bucketName}/${fileName}`);
		// const [result] = await client.textDetection("./captcha.png");
		// const detections = result.textAnnotations;
		// console.log("Text:");
		// detections.forEach((text) => console.log(text));
	} catch (error) {
		console.error(error);
	}
})();
